"use strict";var Ie=Object.create;var T=Object.defineProperty;var De=Object.getOwnPropertyDescriptor;var Ue=Object.getOwnPropertyNames;var _e=Object.getPrototypeOf,ze=Object.prototype.hasOwnProperty;var qe=(r,e)=>{for(var o in e)T(r,o,{get:e[o],enumerable:!0})},Y=(r,e,o,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ue(e))!ze.call(r,i)&&i!==o&&T(r,i,{get:()=>e[i],enumerable:!(t=De(e,i))||t.enumerable});return r};var B=(r,e,o)=>(o=r!=null?Ie(_e(r)):{},Y(e||!r||!r.__esModule?T(o,"default",{value:r,enumerable:!0}):o,r)),Ae=r=>Y(T({},"__esModule",{value:!0}),r);var ao={};qe(ao,{getChromeCookie:()=>Z,getCookie:()=>w,getFirefoxCookie:()=>J,getGroupedRenderedCookies:()=>K,getMergedRenderedCookies:()=>X});module.exports=Ae(ao);var re=require("consola");var ee=require("os"),oe=require("dotenv"),O=require("zod");(0,oe.config)();var $e=O.z.object({LOG_LEVEL:O.z.enum(["debug","info","warn","error"]).default("info"),HOME:O.z.string().optional().transform(r=>r??process.env.USERPROFILE??"").pipe(O.z.string().min(1))}),M=$e.parse({LOG_LEVEL:process.env.LOG_LEVEL,HOME:(0,ee.homedir)()});var Qe=(0,re.createConsola)({fancy:!0,formatOptions:{showLogLevel:!1,colors:!0,date:!1,compact:!0,columns:typeof process.stdout.columns=="number"?process.stdout.columns:80},level:M.LOG_LEVEL==="debug"?5:2}),uo=M.LOG_LEVEL==="debug",Ne=Qe,u=Ne;function te(r,e,o){e?u.success(`${r} succeeded`,o):u.error(`${r} failed`,o)}function p(r,e,o){let t=e instanceof Error?e.message:String(e);u.error(r,{...o,error:t})}function y(r,e,o){u.warn(`[${r}] ${e}`,o)}function g(r){return u.withTag(r)}var ae=require("fs"),D=require("path"),fe=B(require("fast-glob"),1);var ie=require("os"),se=require("path"),E=(()=>{let r=(0,ie.homedir)();if(!r)throw new Error("Unable to determine user home directory");return(0,se.join)(r,"Library","Application Support","Google","Chrome")})();var ne=B(require("better-sqlite3"),1);function Me(r){try{return new ne.default(r,{readonly:!0,fileMustExist:!0})}catch(e){throw p("Database open failed",e,{file:r}),e}}function je(r){try{return r.close(),Promise.resolve()}catch(e){return p("Database close failed",e),Promise.reject(e instanceof Error?e:new Error("Failed to close database: Unknown error"))}}async function I({file:r,sql:e,params:o,rowFilter:t,rowTransform:i}){let s;try{s=Me(r);let c=s.prepare(e).all(o),f=t?c.filter(t):c;return i?f.map(i):f}catch(n){throw p("Database query failed",n,{file:r,sql:e}),n}finally{s&&await je(s)}}var P=g("getEncryptedChromeCookie");function Ve(r){if(typeof r!="string")return!1;let e=r.trim();return e.length===0?!1:(0,ae.existsSync)(e)}async function He(){let r=[(0,D.join)(E,"Default/Cookies"),(0,D.join)(E,"Profile */Cookies"),(0,D.join)(E,"Profile Default/Cookies")],e=[];for(let o of r){let t=await(0,fe.default)(o);e.push(...t)}return P.debug("ChromeCookies","Found cookie files",{count:e.length,files:e}),e}function Ge(r,e){let o=r==="%",t=o?"SELECT name, encrypted_value, host_key, expires_utc FROM cookies WHERE host_key LIKE ?":"SELECT name, encrypted_value, host_key, expires_utc FROM cookies WHERE name = ? AND host_key LIKE ?",i=o?[`%${e}%`]:[r,`%${e}%`];return{sql:t,params:i}}async function We(r,e,o){try{let{sql:t,params:i}=Ge(e,o);P.debug("ChromeCookies","Executing query",{sql:t,params:i});let s=await I({file:r,sql:t,params:i,rowTransform:n=>({name:n.name,domain:n.host_key,value:n.encrypted_value,expiry:n.expires_utc})});return te("QueryCookies",!0,{file:r,count:s.length}),s}catch(t){return p("Failed to read cookie file",t,{file:r}),[]}}async function ce({name:r,domain:e,file:o}){let t=typeof o=="string"&&o.length>0?[o]:await He();if(t.length===0)return P.debug("ChromeCookies","No cookie files found"),[];let i=[];for(let s of t){if(!Ve(s)){P.debug("ChromeCookies","Cookie file missing or invalid",{file:s});continue}let n=await We(s,r,e);i.push(...n)}return P.debug("ChromeCookies","Query complete",{totalCookies:i.length}),i}var Ze=require("fs"),Je=require("path"),me=B(require("fast-glob"),1);var Ke=g("listChromeProfiles");function ue(){let r=me.default.sync("./**/Cookies",{cwd:E,absolute:!0});return Ke.debug("Found cookie files:",r),r}var U=require("crypto"),j=require("lodash-es"),Xe=(0,j.memoize)(r=>r.length>=3&&r[0]===118&&r[1]===49&&r[2]===48?r.slice(3):r,r=>r.toString("hex")),Ye=(0,j.memoize)(r=>{let e=r[r.length-1];return e&&e<=16?r.slice(0,-e):r},r=>r.toString("hex"));function eo(r){let e=[/.*?0t(.+)$/,/.*?1e`(.+)$/,/.*?[`'](.+)$/,/[^\x20-\x7E]*([\x20-\x7E].+)$/];for(let o of e){let i=r.match(o)?.[1]??"";if(i.length>0)return i}return r}async function pe(r,e){if(typeof e!="string")throw new Error("password must be a string");if(!Buffer.isBuffer(r))throw new Error("encryptedData must be a Buffer");return new Promise((o,t)=>{(0,U.pbkdf2)(e,"saltysalt",1003,16,"sha1",(i,s)=>{try{if(i){t(new Error("Failed to derive key: "+i.message));return}let n=Xe(r);if(n.length%16!==0){t(new Error("Encrypted data length is not a multiple of 16"));return}let c=Buffer.alloc(16," "),f=(0,U.createDecipheriv)("aes-128-cbc",s,c);f.setAutoPadding(!1);let m=f.update(n);try{f.final()}catch(d){t(new Error("Failed to finalize decryption: "+d.message));return}m=Ye(m);let l=m.toString("utf8");o(eo(l))}catch(n){t(new Error("Decryption failed: "+n.message))}})})}var H=require("os");var le=require("child_process"),ge=require("util");var oo=(0,ge.promisify)(le.exec),V=class extends Error{constructor(o,t,i){super(o);this.command=t;this.originalError=i;this.name="CommandExecutionError"}};async function de(r,e){try{let o=await oo(r,{...e,encoding:"utf8"});return{stdout:o.stdout.toString(),stderr:o.stderr.toString()}}catch(o){throw p("Command execution failed",o,{command:r}),new V(o instanceof Error?o.message:String(o),r,o instanceof Error?o:void 0)}}async function ye(){return(await de('security find-generic-password -w -s "Chrome Safe Storage"')).stdout.trim()}async function he(){switch((0,H.platform)()){case"darwin":return ye();default:throw new Error(`Platform ${(0,H.platform)()} is not supported`)}}function ro(r){return typeof r!="number"||r<=0?"Infinity":new Date(r)}function Ce(r,e,o,t,i,s){return{domain:r,name:e,value:o,expiry:ro(t),meta:{file:i,browser:"Chrome",decrypted:s}}}var S=class{constructor(){this.logger=g("ChromeCookieQueryStrategy");this.browserName="Chrome"}async queryCookies(e,o,t){try{if(this.logger.info("Querying cookies",{name:e,domain:o,store:t}),process.platform!=="darwin")return this.logger.warn("Platform not supported",{platform:process.platform}),[];let i=t??ue(),s=Array.isArray(i)?i:[i];if(s.length===0)return this.logger.warn("No Chrome cookie files found"),[];let n=await he();return(await Promise.all(s.map(f=>this.processFile(f,e,o,n)))).flat()}catch(i){return i instanceof Error?p("Failed to query cookies",i,{name:e,domain:o}):p("Failed to query cookies",new Error(String(i)),{name:e,domain:o}),[]}}async processFile(e,o,t,i){try{let s=await ce({name:o,domain:t,file:e}),n={file:e,password:i};return(await Promise.allSettled(s.map(f=>this.processCookie(f,n)))).map(f=>f.status==="fulfilled"?f.value:null).filter(f=>f!==null)}catch(s){return s instanceof Error?this.logger.error("Failed to process cookie file",{error:s,file:e}):this.logger.error("Failed to process cookie file",{error:String(s),file:e}),[]}}async processCookie(e,o){try{let t=Buffer.isBuffer(e.value)?e.value:Buffer.from(String(e.value)),i=await pe(t,o.password);return Ce(e.domain,e.name,i,e.expiry,o.file,!0)}catch(t){return t instanceof Error?this.logger.warn("Failed to decrypt cookie",{error:t}):this.logger.warn("Failed to decrypt cookie",{error:String(t)}),Ce(e.domain,e.name,e.value.toString("utf-8"),e.expiry,o.file,!1)}}};var ke=require("os"),G=require("path"),be=B(require("fast-glob"),1);var to=g("FirefoxCookieQueryStrategy");function io(){let r=(0,ke.homedir)();if(!r)return y("FirefoxCookieQuery","Failed to get home directory"),[];let e=[(0,G.join)(r,"Library/Application Support/Firefox/Profiles/*/cookies.sqlite"),(0,G.join)(r,".mozilla/firefox/*/cookies.sqlite")],o=[];for(let t of e){let i=be.default.sync(t);o.push(...i)}return to.debug("Found Firefox cookie files",{files:o}),o}var v=class{constructor(){this.browserName="Firefox"}async queryCookies(e,o,t){let i=t??io(),s=Array.isArray(i)?i:[i],n=[];for(let c of s)try{let f=await I({file:c,sql:"SELECT name, value, host as domain, expiry FROM moz_cookies WHERE name = ? AND host LIKE ?",params:[e,`%${o}%`],rowTransform:m=>({name:m.name,value:m.value,domain:m.domain,expiry:m.expiry>0?new Date(m.expiry*1e3):"Infinity",meta:{file:c,browser:"Firefox",decrypted:!1}})});n.push(...f)}catch(f){f instanceof Error?y("FirefoxCookieQuery",`Error reading Firefox cookie file ${c}`,{error:f.message}):y("FirefoxCookieQuery",`Error reading Firefox cookie file ${c}`)}return n}};var Fe=require("os"),Le=require("path");var ve=require("buffer"),Re=require("fs"),Be=require("os"),Oe=require("path");var q=require("buffer");var we=B(require("destr"),1),a=require("zod"),_=a.z.string().trim().min(1,"Domain cannot be empty").refine(r=>/^\.?[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(r),"Invalid domain format"),z=a.z.string().trim().min(1,"Cookie name cannot be empty").refine(r=>r==="%"||/^[!#$%&'()*+\-.:0-9A-Z \^_`a-z|~]+$/.test(r),"Invalid cookie name format - must contain only valid characters (letters, numbers, and certain symbols) or be '%' for wildcard"),xe=a.z.string().trim().min(1,"Path cannot be empty").refine(r=>r.startsWith("/"),"Path must start with /").refine(r=>/^\/[!#$%&'()*+,\-./:=@\w~]*$/.test(r),"Invalid path format - must contain only valid URL path characters").default("/"),Ee=a.z.string().trim().transform(r=>(0,we.default)(r)).pipe(a.z.any()),Se=a.z.object({name:z,value:Ee,domain:_,path:xe,expiry:a.z.number().int(),creation:a.z.number().int(),flags:a.z.number().optional(),version:a.z.number().int().optional(),port:a.z.number().int().optional(),comment:a.z.string().optional(),commentURL:a.z.string().optional()}),Vo=a.z.object({name:z,domain:_}).strict(),so=a.z.object({file:a.z.string().trim().min(1,"File path cannot be empty").optional(),browser:a.z.string().trim().optional(),decrypted:a.z.boolean().optional(),secure:a.z.boolean().optional(),httpOnly:a.z.boolean().optional(),path:xe.optional()}).catchall(a.z.unknown()).strict(),F=a.z.object({domain:_,name:z,value:Ee,expiry:a.z.union([a.z.literal("Infinity"),a.z.date(),a.z.number().int().positive("Expiry must be a positive number")]).optional(),meta:so.optional()}).strict(),Ho=a.z.object({expiry:a.z.number().int().optional(),domain:_,name:z,value:a.z.union([a.z.string(),a.z.instanceof(Buffer)])}).strict(),Go=a.z.object({format:a.z.enum(["merged","grouped"]).optional(),separator:a.z.string().optional(),showFilePaths:a.z.boolean().optional()}).strict(),no=a.z.enum(["Chrome","Firefox","Safari","internal","unknown"]),Wo=a.z.object({browserName:no,queryCookies:a.z.function().args(a.z.string(),a.z.string(),a.z.string().optional()).returns(a.z.promise(a.z.array(F)))}).strict();var k=g("BinaryCodableCookie"),A=class{constructor(e){this.version=0;this.url="";this.name="";this.path="";this.value="";this.flags={isSecure:!1,isHTTPOnly:!1,unknown1:!1,unknown2:!1};this.expiration=0;this.creation=0;let o={offset:0,buffer:e};this.decode(o)}decodeUrlValue(e){let o=e,t;do{t=o;try{o=decodeURIComponent(o)}catch{return t}}while(o!==t&&o.includes("%"));return o}decodeJwtPayload(e){let o=e.split(".");if(o.length!==3)return null;try{let t=q.Buffer.from(o[1],"base64").toString("utf8"),i=JSON.parse(t);return JSON.stringify(i)}catch{return null}}parseJsonValue(e){try{let o=JSON.parse(e);return JSON.stringify(o)}catch{return null}}processValue(e){let o=this.decodeUrlValue(e);if(o.match(/^ey[A-Za-z0-9_-]+\.ey[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+$/)){let t=this.decodeJwtPayload(o);if(typeof t=="string"&&t.length>0)return t}if(o.startsWith("{")||o.startsWith("[")){let t=this.parseJsonValue(o);if(typeof t=="string"&&t.length>0)return t}return o}toCookieRow(){try{let e=this.convertFlags(),o=this.url.replace(/^https?:\/\//,"").replace(/\/.*$/,"")||"uk",t=978307200,i=this.expiration>0?this.expiration+t:this.expiration,s=this.creation>0?this.creation+t:this.creation;return Se.parse({name:this.name.replace(/^: /,""),value:this.processValue(this.value)||"",domain:o,path:this.path||"/",expiry:i,creation:s,flags:e,version:this.version,port:this.port,comment:this.comment,commentURL:this.commentURL})}catch{return null}}readNullTerminatedString(e,o){let t=o;for(;t<e.buffer.length&&e.buffer[t]!==0;)t++;return e.buffer.toString("utf8",o,t)||""}readHeader(e){let o=e.buffer.readUInt32LE(e.offset);k.debug("Cookie size:",o),e.offset+=4;let t=e.buffer.readUInt32LE(e.offset);k.debug("Cookie version:",t),e.offset+=4;let i=e.buffer.readUInt32LE(e.offset);k.debug("Cookie flags:",i.toString(2).padStart(8,"0")),e.offset+=4,this.flags={isSecure:(i&1)!==0,isHTTPOnly:(i&4)!==0,unknown1:(i&8)!==0,unknown2:(i&16)!==0};let s=e.buffer.readUInt32LE(e.offset);k.debug("Has port:",s),e.offset+=4;let n={urlOffset:e.buffer.readUInt32LE(e.offset),nameOffset:e.buffer.readUInt32LE(e.offset+4),pathOffset:e.buffer.readUInt32LE(e.offset+8),valueOffset:e.buffer.readUInt32LE(e.offset+12),commentOffset:e.buffer.readUInt32LE(e.offset+16),commentURLOffset:e.buffer.readUInt32LE(e.offset+20)};return k.debug("String offsets:",n),{size:o,hasPort:s,offsets:n}}readTimestamps(e){let o=q.Buffer.alloc(8);for(let n=0;n<8;n++)o[n]=e.buffer[e.offset+n];let t=o.readDoubleLE(0);e.offset+=8;let i=q.Buffer.alloc(8);for(let n=0;n<8;n++)i[n]=e.buffer[e.offset+n];let s=i.readDoubleLE(0);e.offset+=8,this.expiration=t,this.creation=s}readStrings(e,o,t){k.debug("Reading strings from cookie buffer of size:",o);let s=[{field:"url",offset:t.urlOffset},{field:"name",offset:t.nameOffset},{field:"path",offset:t.pathOffset},{field:"value",offset:t.valueOffset},{field:"comment",offset:t.commentOffset}].filter(n=>n.offset>0).sort((n,c)=>n.offset-c.offset);k.debug("Reading strings in order:",s.map(n=>n.field));for(let n=0;n<s.length;n++){let{field:c,offset:f}=s[n],l=(n<s.length-1?s[n+1].offset:o)-f,d=0+f;for(;d<0+f+l&&e.buffer[d]!==0;)d++;let x=e.buffer.toString("utf8",0+f,d);switch(k.debug(`Read ${c}:`,x),c){case"url":this.url=x;break;case"name":this.name=x;break;case"path":this.path=x;break;case"value":this.value=x;break;case"comment":this.comment=x;break}}}decode(e){let{size:o,hasPort:t,offsets:i}=this.readHeader(e),s=e.offset;e.offset=s+24,this.readTimestamps(e),t>0&&(this.port=e.buffer.readUInt16LE(e.offset),e.offset+=2),e.offset=s,this.readStrings(e,o,i)}convertFlags(){return(this.flags.isSecure?1:0)|(this.flags.isHTTPOnly?4:0)|(this.flags.unknown1?8:0)|(this.flags.unknown2?16:0)}};var h=g("BinaryCodablePage"),R=class R{constructor(e){this.cookies=[];let o={offset:0,buffer:e};this.decode(o)}toCookieRows(){let e=[];for(let o of this.cookies)try{let t=o.toCookieRow();t!==null&&e.push(t)}catch(t){let i=t instanceof Error?t.message:String(t);y("BinaryCookies","Error converting cookie",{error:i})}return e}decode(e){let o=e.buffer.readUInt32BE(e.offset);if(h.debug("Page header:",o.toString(16)),e.offset+=4,o!==R.HEADER)throw new Error("Invalid page header");let t=e.buffer.readUInt32LE(e.offset);h.debug("Cookie count:",t),e.offset+=4;let i=e.offset-8;h.debug("Page start offset:",i);let s=[];for(let c=0;c<t;c++){let f=e.buffer.readUInt32LE(e.offset);s.push(f),h.debug(`Cookie ${c} offset:`,f),e.offset+=4}let n=e.buffer.readUInt32BE(e.offset);if(h.debug("Page footer:",n.toString(16)),e.offset+=4,n!==R.FOOTER)throw new Error("Invalid page footer");for(let c=0;c<t;c++)try{let f=s[c];h.debug(`Reading cookie ${c} at offset:`,f);let m=e.buffer.readUInt32LE(f);if(h.debug(`Cookie ${c} size:`,m),m<48){h.warn(`Invalid cookie size ${m} at index ${c}`);continue}if(f+m>e.buffer.length){h.warn(`Cookie size ${m} at index ${c} would exceed buffer length ${e.buffer.length}`);continue}let l=e.buffer.subarray(f,f+m),d=new A(l);this.cookies.push(d)}catch(f){h.warn("Invalid cookie data",{error:f instanceof Error?f.message:String(f)})}}};R.HEADER=256,R.FOOTER=0;var $=R;var b=g("BinaryCodableCookies"),C=class C{constructor(e){let o={offset:0,buffer:e};this.pages=[],this.metadata={},this.decode(o)}static fromFile(e){let o=(0,Re.readFileSync)(e);return new C(o)}static fromDefaultPath(){return C.fromFile(C.DEFAULT_COOKIE_PATH)}toCookieRows(){let e=[];for(let o of this.pages)try{let t=o.toCookieRows();Array.isArray(t)&&e.push(...t)}catch(t){let i=t instanceof Error?t.message:String(t);y("BinaryCookies","Error converting page cookies",{error:i})}return e}decode(e){try{let o=e.buffer.subarray(e.offset,e.offset+4);if(e.offset+=4,b.debug("Magic bytes:",o.toString()),!o.equals(C.MAGIC))throw new Error("Missing magic value");let t=e.buffer.readUInt32BE(e.offset);b.debug("Page count:",t),e.offset+=4;let i=[];for(let m=0;m<t;m++){let l=e.buffer.readUInt32BE(e.offset);i.push(l),b.debug(`Page ${m} size:`,l),e.offset+=4}let s=e.offset;b.debug("Starting page data at offset:",s);for(let m of i)try{b.debug("Reading page at offset:",s,"with size:",m);let l=e.buffer.subarray(s,s+m),d=new $(l);this.pages.push(d),s+=m}catch(l){let d=l instanceof Error?l.message:String(l);b.warn("Error decoding page:",{error:d}),s+=m}e.offset=s;let n=e.buffer.readUInt32BE(e.offset);b.debug("Checksum:",n.toString(16)),e.offset+=4;let c=e.buffer.readBigUInt64BE(e.offset);b.debug("Footer:",c.toString(16)),e.offset+=8,c!==C.FOOTER&&y("BinaryCookies","Invalid cookie file format: wrong footer");let f=e.buffer.subarray(e.offset);this.metadata={}}catch(o){let t=o instanceof Error?o.message:String(o);throw y("BinaryCookies","Error decoding binary cookies file",{error:t}),o}}};C.MAGIC=ve.Buffer.from("cook","utf8"),C.FOOTER=BigInt("0x071720050000004b"),C.DEFAULT_COOKIE_PATH=(0,Oe.join)((0,Be.homedir)(),"Library/Containers/com.apple.Safari/Data/Library/Cookies/Cookies.binarycookies");var Q=C;function Pe(r){return Q.fromFile(r).toCookieRows()}var N=class{constructor(){this.browserName="Safari"}getCookieDbPath(e){return(0,Le.join)(e,"Library","Containers","com.apple.Safari","Data","Library","Cookies","Cookies.binarycookies")}formatDomain(e){return e.startsWith(".")?e.slice(1):e}formatExpiry(e){return e<=0?"Infinity":new Date(e*1e3)}isFlagSet(e,o){return typeof e!="number"||isNaN(e)||e<=0?!1:(e&o)===o}formatCreation(e){if(!(typeof e!="number"||isNaN(e)||e<=0))return e*1e3}decodeCookies(e,o,t){try{return Pe(e).filter(s=>(o==="%"||s.name===o)&&(t==="%"||this.formatDomain(s.domain).includes(t))).map(s=>({domain:this.formatDomain(s.domain),name:s.name,value:Buffer.isBuffer(s.value)?s.value.toString():String(s.value),expiry:this.formatExpiry(s.expiry),meta:{file:e,browser:"Safari",decrypted:!1,secure:this.isFlagSet(s.flags,1),httpOnly:this.isFlagSet(s.flags,4),path:s.path,version:s.version,comment:s.comment,commentURL:s.commentURL,port:s.port,creation:this.formatCreation(s.creation)}}))}catch(i){return i instanceof Error?p("SafariCookieQueryStrategy",`Error decoding ${e}`,{error:i,name:o,domain:t}):p("SafariCookieQueryStrategy",`Error decoding ${e}`,{error:"Unknown error",name:o,domain:t}),[]}}async queryCookies(e,o,t){let i=(0,Fe.homedir)();if(typeof i!="string"||i.length===0)return p("SafariCookieQueryStrategy","Failed to get home directory"),Promise.resolve([]);let s=t??this.getCookieDbPath(i);return Promise.resolve(this.decodeCookies(s,e||"%",o||"%"))}};async function W(r){if(!r.name||!r.domain)return[];let{name:e,domain:o}=r;if(typeof e!="string"||typeof o!="string")return[];let t=[new S,new v,new N];return(await Promise.allSettled(t.map(s=>s.queryCookies(e,o)))).filter(s=>s.status==="fulfilled").flatMap(s=>s.value)}async function w(r){try{return await W(r)}catch(e){return u.warn("Error querying cookies:",e instanceof Error?e.message:String(e)),[]}}async function Z(r){try{return await new S().queryCookies(r.name,r.domain)}catch(e){return u.warn("Error querying Chrome cookies:",e),[]}}async function J(r){try{return await new v().queryCookies(r.name,r.domain)}catch(e){return u.warn("Error querying Firefox cookies:",e instanceof Error?e.message:String(e)),[]}}var Te=require("lodash-es");function L(r,e={}){let{format:o="merged",showFilePaths:t=!0,separator:i="; "}=e;if(r.length===0)return o==="merged"?"":[];if(o==="merged")return r.map(n=>n.value).join(i);let s=(0,Te.groupBy)(r,n=>n.meta?.file??"unknown");return Object.entries(s).map(([n,c])=>{let f=c.map(m=>m.value).join(i);return t?`${n}: ${f}`:f})}async function K(r,e={}){try{let o=await w(r);if(!Array.isArray(o))return[];let t=o.filter(i=>{let s=F.safeParse(i);return s.success?!0:(u.warn("Invalid cookie format:",s.error.format()),!1)});return L(t,{...e,format:"grouped"})}catch(o){return u.warn("Error getting grouped rendered cookies:",o instanceof Error?o.message:String(o)),[]}}async function X(r,e){try{let o=await w(r);if(!Array.isArray(o))return"";let t=o.filter(s=>{let n=F.safeParse(s);return n.success?!0:(u.warn("Invalid cookie format:",n.error.format()),!1)}),i=L(t,{...e,format:"merged"});return typeof i=="string"?i:""}catch(o){return u.warn("Error getting merged rendered cookies:",o instanceof Error?o.message:String(o)),""}}0&&(module.exports={getChromeCookie,getCookie,getFirefoxCookie,getGroupedRenderedCookies,getMergedRenderedCookies});
//# sourceMappingURL=index.cjs.map